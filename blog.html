<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <title>Virtual Utopia Designz — Blog</title>
  <meta name="description" content="Stories, rituals, and behind-the-scenes notes from Virtual Utopia Designz — altar art, cosmic inspiration, and mythic packs." />

  <!-- Open Graph -->
  <meta property="og:title" content="Virtual Utopia Designz — Blog" />
  <meta property="og:description" content="Ritual notes, cosmic art process, and mythic pack lore — fresh posts from the Enchanted Atelier." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://your-domain.com/blog.html" />
  <meta property="og:image" content="assets/og-blog.jpg" />

  <link rel="canonical" href="https://your-domain.com/blog.html" />
  <link rel="alternate" type="application/rss+xml" title="Virtual Utopia Designz Blog" href="feed.xml" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,600;9..144,700&family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />

  <style>
    :root{
      --bg0:#070814;
      --bg1:#0b1026;
      --bg2:#111a3a;
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.10);
      --stroke:rgba(255,255,255,.14);
      --stroke2:rgba(255,255,255,.20);
      --text:#eef1ff;
      --muted:rgba(238,241,255,.72);
      --faint:rgba(238,241,255,.52);
      --gold:#ffd88a;
      --gold2:#f5c468;
      --violet:#bda7ff;
      --aqua:#7be7ff;
      --success:#7ff0b7;
      --danger:#ff7ea6;
      --shadow:0 18px 60px rgba(0,0,0,.55);
      --shadow2:0 28px 90px rgba(0,0,0,.62);
      --r12:12px;
      --r16:16px;
      --r22:22px;
      --r28:28px;
      --max:1160px;
      --sans:"Inter", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      --serif:"Fraunces", ui-serif, Georgia, "Times New Roman", serif;
      --ease:cubic-bezier(.2,.8,.2,1);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 10% 15%, rgba(189,167,255,.18), transparent 55%),
        radial-gradient(900px 500px at 85% 20%, rgba(123,231,255,.14), transparent 55%),
        radial-gradient(900px 600px at 70% 90%, rgba(255,216,138,.12), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1) 40%, var(--bg2));
      background-attachment: fixed;
      overflow-x:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    a{color:inherit; text-decoration:none}

    /* Starfield */
    .stars, .stars::before, .stars::after{
      position:fixed;
      inset:-200px;
      content:"";
      background-image:
        radial-gradient(1px 1px at 20px 30px, rgba(255,255,255,.55), transparent 55%),
        radial-gradient(1px 1px at 110px 140px, rgba(255,255,255,.35), transparent 55%),
        radial-gradient(1.2px 1.2px at 260px 220px, rgba(255,255,255,.40), transparent 55%),
        radial-gradient(1px 1px at 340px 80px, rgba(255,255,255,.28), transparent 55%),
        radial-gradient(1.2px 1.2px at 480px 160px, rgba(255,255,255,.32), transparent 55%),
        radial-gradient(1px 1px at 620px 260px, rgba(255,255,255,.30), transparent 55%),
        radial-gradient(1px 1px at 760px 120px, rgba(255,255,255,.32), transparent 55%),
        radial-gradient(1.2px 1.2px at 900px 240px, rgba(255,255,255,.30), transparent 55%),
        radial-gradient(1px 1px at 1040px 90px, rgba(255,255,255,.26), transparent 55%);
      background-size:1100px 320px;
      opacity:.35;
      pointer-events:none;
      z-index:-2;
      /* animation removed to prevent moving background on zoom */
    }
    .stars::before{opacity:.22; filter:blur(.2px)}
    .stars::after{opacity:.16; filter:blur(.6px)}
    @keyframes drift{from{transform:translate3d(0,0,0)}to{transform:translate3d(-160px, 220px, 0)}}

    /* Layout */
    .wrap{
      width:min(var(--max), 100%);
      margin:0 auto;
      padding:22px 18px 64px;
      position:relative;
      z-index:1;
    }

    /* Top announcement */
    .announce{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      padding:10px 12px;
      border-radius:999px;
      background:linear-gradient(90deg, rgba(255,216,138,.16), rgba(189,167,255,.14), rgba(123,231,255,.14));
      border:1px solid rgba(255,255,255,.14);
      box-shadow:0 14px 40px rgba(0,0,0,.25);
      margin:14px auto 18px;
      max-width:980px;
      backdrop-filter: blur(10px) saturate(140%);
      font-size:13px;
      color:var(--muted);
      letter-spacing:.02em;
    }
    .announce b{color:var(--text); font-weight:700}
    .announce .pill{
      font-size:12px;
      font-weight:800;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:#0b1026;
      background:linear-gradient(135deg, var(--gold), var(--gold2));
      padding:6px 10px;
      border-radius:999px;
      box-shadow:0 10px 28px rgba(255,216,138,.22);
      flex:0 0 auto;
    }

    /* Header */
    header{
      position:sticky;
      top:14px;
      z-index:50;
      border-radius:999px;
      padding:10px 12px;
      background:rgba(10,12,26,.55);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:var(--shadow);
      backdrop-filter: blur(14px) saturate(140%);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width:0;
    }
    .mark{
      width:42px;
      height:42px;
      border-radius:14px;
      background:
        radial-gradient(circle at 28% 28%, rgba(255,216,138,.98), rgba(255,216,138,.12) 55%, transparent 72%),
        linear-gradient(135deg, rgba(189,167,255,.82), rgba(123,231,255,.55));
      border:1px solid rgba(255,255,255,.18);
      box-shadow:0 18px 50px rgba(189,167,255,.22), 0 12px 40px rgba(255,216,138,.12);
      position:relative;
      overflow:hidden;
      flex:0 0 auto;
    }
    .mark::after{
      content:"";
      position:absolute;
      inset:-50%;
      background:conic-gradient(from 180deg, rgba(255,216,138,.0), rgba(255,216,138,.45), rgba(123,231,255,.2), rgba(189,167,255,.22), rgba(255,216,138,.0));
      animation: spin 10s linear infinite;
      opacity:.65;
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    .brand .name{
      font-family:var(--serif);
      font-weight:700;
      letter-spacing:-.02em;
      font-size:16px;
      line-height:1.1;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .brand .tag{
      font-size:12px;
      color:var(--faint);
      margin-top:3px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    nav{
      display:flex;
      align-items:center;
      gap:6px;
      padding:6px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.04);
    }
    nav a{
      padding:10px 12px;
      border-radius:999px;
      font-size:13px;
      font-weight:700;
      color:var(--muted);
      letter-spacing:.02em;
      transition:transform .18s var(--ease), background-color .18s var(--ease), color .18s var(--ease);
      outline:none;
    }
    nav a:hover, nav a:focus-visible{
      background:rgba(255,255,255,.08);
      color:var(--text);
      transform:translateY(-1px);
    }
    nav a[aria-current="page"]{
      background:rgba(255,255,255,.10);
      color:var(--text);
      border:1px solid rgba(255,255,255,.14);
    }

    .actions{
      display:flex;
      align-items:center;
      gap:8px;
    }


/* Mobile menu (keeps desktop unchanged) */
.menuBtn{display:none}
.mobile-drawer{
  position:fixed;
  inset:0;
  display:none;
  background:rgba(0,0,0,.62);
  z-index:200;
  padding:18px;
}
.mobile-drawer.active{display:block}
.mobile-panel{
  width:min(520px, 100%);
  margin:72px auto 0;
  border-radius:24px;
  border:1px solid rgba(255,255,255,.16);
  background:rgba(10,12,26,.92);
  backdrop-filter: blur(18px) saturate(140%);
  box-shadow:0 30px 120px rgba(0,0,0,.65);
  overflow:hidden;
}
.mobile-panel .head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:14px 14px 12px;
  border-bottom:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.03);
}
.mobile-panel .head b{font-family:var(--serif); letter-spacing:-.01em}
.mobile-links{
  display:flex;
  flex-direction:column;
  gap:6px;
  padding:12px 12px 14px;
}
.mobile-links a{
  padding:12px 12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.03);
  font-weight:900;
  color:var(--text);
}
.mobile-links a:active{transform:scale(.99)}
.mobile-cta{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  padding:0 12px 14px;
}
.mobile-cta a{flex:1}
.menuIcon{width:18px;height:18px}

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding:11px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:var(--text);
      font-weight:800;
      letter-spacing:.02em;
      font-size:13px;
      transition:transform .18s var(--ease), filter .18s var(--ease), box-shadow .18s var(--ease), background-color .18s var(--ease);
      cursor:pointer;
      user-select:none;
      white-space:nowrap;
      outline:none;
    }
    .btn:hover{transform:translateY(-1px); background:rgba(255,255,255,.09)}
    .btn:focus-visible{box-shadow:0 0 0 4px rgba(123,231,255,.22)}

    .btn-primary{
      border:none;
      color:#0b1026;
      background:linear-gradient(135deg, var(--gold), var(--gold2));
      box-shadow:0 18px 52px rgba(255,216,138,.16);
    }
    .btn-primary:hover{filter:brightness(1.05)}

    .icon{
      width:16px; height:16px; display:inline-block; flex:0 0 auto;
    }

    /* Hero */
    .hero{
      margin:18px 0 34px;
      border-radius:var(--r28);
      border:1px solid rgba(255,255,255,.12);
      background:
        radial-gradient(900px 420px at 20% 25%, rgba(189,167,255,.18), transparent 55%),
        radial-gradient(700px 380px at 80% 15%, rgba(123,231,255,.14), transparent 55%),
        radial-gradient(900px 520px at 60% 90%, rgba(255,216,138,.12), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow:var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .hero::before{
      content:"";
      position:absolute;
      inset:-2px;
      background:linear-gradient(90deg, rgba(255,216,138,.28), rgba(189,167,255,.24), rgba(123,231,255,.22));
      opacity:.12;
      filter:blur(18px);
      pointer-events:none;
    }

    .hero-inner{
      display:grid;
      grid-template-columns: 1.08fr .92fr;
      gap:24px;
      padding:34px;
      position:relative;
      z-index:1;
      align-items:center;
    }

    .kicker{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color:var(--muted);
      font-size:12px;
      font-weight:800;
      letter-spacing:.14em;
      text-transform:uppercase;
      width:max-content;
    }
    .dot{
      width:8px; height:8px; border-radius:50%;
      background:linear-gradient(135deg, var(--gold), var(--aqua));
      box-shadow:0 0 20px rgba(255,216,138,.18);
    }

    h1{
      font-family:var(--serif);
      font-weight:700;
      letter-spacing:-.03em;
      margin:14px 0 10px;
      font-size: clamp(34px, 4.2vw, 56px);
      line-height:1.04;
    }

    .lead{
      color:var(--muted);
      font-size: clamp(15px, 1.5vw, 18px);
      line-height:1.55;
      margin:0 0 18px;
      max-width:55ch;
    }

    .hero-ctas{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:14px;
    }

    .trust{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:18px;
      color:var(--faint);
      font-size:13px;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:9px 12px;
      border-radius:999px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
    }
    .chip b{color:var(--text)}

    /* Right hero card */
    .hero-card{
      border-radius:24px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 18px 60px rgba(0,0,0,.35);
      overflow:hidden;
    }
    .hero-card .top{
      padding:18px 18px 14px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
    }
    .hero-card h2{
      font-family:var(--serif);
      margin:0;
      font-size:18px;
      letter-spacing:-.01em;
    }
    .hero-card .sub{
      margin:6px 0 0;
      color:var(--faint);
      font-size:13px;
      line-height:1.4;
    }

    .mini-grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:10px;
      padding:0 18px 18px;
    }
    .mini{
      border-radius:16px;
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
      position:relative;
      transition: transform .18s var(--ease), box-shadow .18s var(--ease), border-color .18s var(--ease);
    }
    .mini:hover{transform:translateY(-2px); border-color:rgba(255,255,255,.16); box-shadow:0 16px 60px rgba(0,0,0,.35)}
    .mini img{width:100%; height:auto; display:block; aspect-ratio:4/5; object-fit:cover; filter:saturate(1.05) contrast(1.05)}
    .mini .cap{padding:10px 10px 12px}
    .mini .cap .t{font-weight:800; font-size:13px; letter-spacing:.01em}
    .mini .cap .p{color:var(--faint); font-size:12px; margin-top:4px}
    .tag-badge{
      position:absolute;
      top:10px; left:10px;
      padding:6px 9px;
      border-radius:999px;
      font-size:11px;
      font-weight:900;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:#0b1026;
      background:linear-gradient(135deg, var(--success), rgba(123,231,255,.85));
      box-shadow:0 14px 40px rgba(127,240,183,.12);
    }
    .tag-badge.hot{background:linear-gradient(135deg, var(--gold), var(--gold2)); box-shadow:0 14px 40px rgba(255,216,138,.14)}

    /* Sections */
    section{
      margin:18px 0;
      border-radius:var(--r28);
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .sec-head{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:14px;
      padding:22px 22px 16px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.10);
    }
    .sec-head h3{
      font-family:var(--serif);
      margin:0;
      font-size:20px;
      letter-spacing:-.01em;
    }
    .sec-head p{
      margin:0;
      color:var(--faint);
      font-size:13px;
      line-height:1.35;
    }

    .grid3{
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap:14px;
      padding:18px 18px 22px;
    }

    .product{
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.035);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height:100%;
      transition: transform .2s var(--ease), box-shadow .2s var(--ease), border-color .2s var(--ease);
      position:relative;
      isolation:isolate;
    }
    .product:hover{transform:translateY(-4px); border-color:rgba(255,255,255,.18); box-shadow:var(--shadow2)}
    .product img{
      width:100%;
      height:auto;
      display:block;
      aspect-ratio:4/5;
      object-fit:cover;
      cursor:pointer;
      background:#0b1026;
    }
    .product .body{padding:14px 14px 16px; display:flex; flex-direction:column; gap:10px; flex:1}
    .product .title{font-weight:900; letter-spacing:-.01em}
    .product .meta{display:flex; align-items:center; justify-content:space-between; gap:8px; color:var(--faint); font-size:13px}
    .price{font-weight:900; color:var(--text)}
    .product .desc{color:var(--muted); font-size:13px; line-height:1.5; flex:1}
    .product .row{display:flex; gap:10px; flex-wrap:wrap}
    .product .row a{flex:1}

    .pill-badge{
      position:absolute;
      top:12px; left:12px;
      padding:7px 10px;
      border-radius:999px;
      font-size:11px;
      font-weight:900;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:#0b1026;
      background:linear-gradient(135deg, rgba(189,167,255,.95), rgba(123,231,255,.85));
      box-shadow:0 14px 44px rgba(189,167,255,.14);
      z-index:2;
    }
    .pill-badge.best{background:linear-gradient(135deg, var(--gold), var(--gold2)); box-shadow:0 14px 44px rgba(255,216,138,.14)}

    .btn-sm{padding:10px 12px; font-size:13px}

    /* Collections */
    .tiles{
      display:grid;
      grid-template-columns:repeat(4, 1fr);
      gap:12px;
      padding:18px;
    }
    .tile{
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      padding:16px 14px;
      transition: transform .2s var(--ease), border-color .2s var(--ease), background-color .2s var(--ease);
      display:flex;
      flex-direction:column;
      gap:8px;
      min-height:120px;
    }
    .tile:hover{transform:translateY(-3px); border-color:rgba(255,255,255,.18); background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04))}
    .tile .t{font-weight:900}
    .tile .s{color:var(--faint); font-size:13px; line-height:1.4}

    /* Value props */
    .value{
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap:12px;
      padding:18px;
    }
    .vcard{
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.035);
      padding:16px 14px;
    }
    .vcard h4{margin:0 0 6px; font-size:14px; letter-spacing:.01em}
    .vcard p{margin:0; color:var(--faint); font-size:13px; line-height:1.5}

    /* Reviews */
    .reviews{
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap:12px;
      padding:18px;
    }
    .review{
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.035);
      padding:16px 14px;
    }
    .starsRow{color:var(--gold); letter-spacing:.12em; font-weight:900; font-size:12px}
    .quote{margin:10px 0 12px; color:var(--muted); font-size:13px; line-height:1.6}
    .who{display:flex; align-items:center; justify-content:space-between; gap:10px; color:var(--faint); font-size:12px}
    .who b{color:var(--text)}

    /* FAQ */
    details{
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
      padding:12px 14px;
    }
    details + details{margin-top:10px}
    summary{cursor:pointer; font-weight:900; list-style:none}
    summary::-webkit-details-marker{display:none}
    details p{margin:10px 0 0; color:var(--faint); font-size:13px; line-height:1.55}

    /* Footer */
    footer{
      margin-top:24px;
      padding:22px;
      border-radius:var(--r28);
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.03);
      box-shadow:var(--shadow);
      display:grid;
      grid-template-columns: 1.2fr .8fr .8fr;
      gap:16px;
    }
    footer h5{
      font-family:var(--serif);
      margin:0 0 8px;
      font-size:16px;
      letter-spacing:-.01em;
    }
    footer p{margin:0; color:var(--faint); font-size:13px; line-height:1.6}
    .links{display:flex; flex-direction:column; gap:10px; font-size:13px}
    .links a{color:var(--muted); font-weight:700}
    .links a:hover{text-decoration:underline; color:var(--text)}

    /* Modal */
    .modal{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      background:rgba(0,0,0,.72);
      z-index:999;
    }
    .modal.active{display:flex}
    .modal-card{
      width:min(920px, 100%);
      border-radius:24px;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(10,12,26,.86);
      backdrop-filter: blur(18px) saturate(140%);
      box-shadow:0 30px 120px rgba(0,0,0,.65);
      overflow:hidden;
    }
    .modal-grid{display:grid; grid-template-columns: 1.1fr .9fr}
    .modal-media{background:rgba(255,255,255,.03)}
    .modal-media img{width:100%; height:100%; object-fit:contain; display:block; max-height:78vh}
    .modal-body{padding:18px 18px 20px}
    .modal-top{display:flex; align-items:flex-start; justify-content:space-between; gap:10px}
    .modal-title{font-family:var(--serif); margin:0; font-size:22px; letter-spacing:-.01em}
    .close{
      border:none;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color:var(--text);
      width:40px; height:40px;
      border-radius:999px;
      cursor:pointer;
      font-size:18px;
    }
    .modal-body p{margin:10px 0 14px; color:var(--muted); font-size:13px; line-height:1.65}
    .modal-actions{display:flex; gap:10px; flex-wrap:wrap}

    /* Newsletter */
    .newsletter{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:12px;
    }
    .field{
      flex:1 1 220px;
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.05);
    }
    .field input{
      width:100%;
      border:none;
      outline:none;
      background:transparent;
      color:var(--text);
      font-weight:600;
      font-size:13px;
    }
    .field input::placeholder{color:rgba(238,241,255,.55)}

    /* Accessibility */
    .skip{
      position:absolute;
      left:-999px;
      top:auto;
      width:1px;
      height:1px;
      overflow:hidden;
    }
    .skip:focus{
      left:18px;
      top:18px;
      width:auto;
      height:auto;
      padding:10px 12px;
      border-radius:12px;
      z-index:1000;
      background:rgba(10,12,26,.9);
      border:1px solid rgba(255,255,255,.18);
      box-shadow:var(--shadow);
      color:var(--text);
    }

    /* Responsive */
    @media (max-width: 980px){
      .menuBtn{display:inline-flex}
      .actions{gap:6px}
      .actions .btn{padding:10px 12px}
      .hero-inner{grid-template-columns:1fr; padding:24px}
      nav{display:none}
      .grid3{grid-template-columns:1fr}
      .tiles{grid-template-columns:1fr 1fr}
      .value{grid-template-columns:1fr}
      .reviews{grid-template-columns:1fr}
      footer{grid-template-columns:1fr}
      .modal-grid{grid-template-columns:1fr}
      .modal-media img{max-height:52vh}
    }

    @media (prefers-reduced-motion: reduce){
      *{animation:none!important; transition:none!important; scroll-behavior:auto!important}
    }
  

    /* Blog page additions (keeps the site aesthetic) */
    .pageHero{
      margin:18px 0 26px;
      border-radius:var(--r28);
      border:1px solid rgba(255,255,255,.12);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow:var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .pageHero::before{
      content:"";
      position:absolute;
      inset:-2px;
      background:linear-gradient(90deg, rgba(255,216,138,.28), rgba(189,167,255,.24), rgba(123,231,255,.22));
      opacity:.10;
      filter:blur(18px);
      pointer-events:none;
    }
    .pageHero .inner{
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap:18px;
      padding:26px;
      position:relative;
      z-index:1;
      align-items:start;
    }
    .pageHero h1{margin:0 0 8px; font-family:var(--serif); letter-spacing:-.02em; font-size:40px; line-height:1.05}
    .pageHero p{margin:0; color:var(--muted); line-height:1.6}

    .blogWrap{display:grid; grid-template-columns: minmax(0,1fr) minmax(280px,360px); gap:22px; align-items:start}

    .searchRow{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px}
    .input{
      flex:1;
      min-width:220px;
      padding:12px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.05);
      color:var(--text);
      outline:none;
      font-weight:700;
    }
    .input::placeholder{color:rgba(238,241,255,.55)}
    .select{
      min-width:180px;
      padding:12px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.05);
      color:var(--text);
      outline:none;
      font-weight:800;
      appearance:none;
      cursor:pointer;
    }

    .posts{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    .postCard{
      border-radius:22px;
      border:1px solid rgba(255,255,255,.12);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow:0 18px 60px rgba(0,0,0,.45);
      overflow:hidden;
      position:relative;
    }
    .postCard::before{
      content:"";
      position:absolute;
      inset:-2px;
      background:linear-gradient(90deg, rgba(255,216,138,.22), rgba(189,167,255,.18), rgba(123,231,255,.16));
      opacity:.10;
      filter:blur(18px);
      pointer-events:none;
    }
    .postIn{position:relative; z-index:1; padding:16px 16px 14px}
    .meta{display:flex; flex-wrap:wrap; gap:10px; align-items:center; color:var(--faint); font-weight:800; font-size:12px; letter-spacing:.06em; text-transform:uppercase}
    .meta .dot{width:6px;height:6px;border-radius:999px;background:linear-gradient(135deg,var(--gold),var(--gold2)); display:inline-block}
    .postTitle{margin:10px 0 8px; font-family:var(--serif); letter-spacing:-.02em; font-size:26px; line-height:1.15}
    .excerpt{margin:0 0 12px; color:var(--muted); line-height:1.65}

    .tagRow{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px}
    .tagChip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.05);
      color:var(--muted);
      font-weight:900;
      font-size:12px;
    }

    .postActions{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; margin-top:12px}
    .readBtn{display:inline-flex}

    .sidePanel{position:sticky; top:24px; display:grid; gap:16px; align-self:start}
    .panel{
      border-radius:22px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.05);
      box-shadow:0 18px 60px rgba(0,0,0,.40);
      padding:14px;
      backdrop-filter: blur(12px) saturate(140%);
    }
    .panel h3{margin:0 0 10px; font-family:var(--serif); letter-spacing:-.01em}
    .panel p{margin:0; color:var(--muted); line-height:1.6}

    .list{display:grid; gap:10px; margin-top:10px}
    .mini{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
    }
    .mini b{display:block; font-size:13px; line-height:1.25}
    .mini span{display:block; margin-top:4px; color:var(--faint); font-size:12px; font-weight:800; letter-spacing:.06em; text-transform:uppercase}

    .pager{display:flex; gap:10px; justify-content:center; margin:16px 0 0}

    /* Article modal */
    .articleModal{position:fixed; inset:0; display:none; z-index:300; background:rgba(0,0,0,.65); padding:18px; overflow-y:auto; -webkit-overflow-scrolling:touch}
    .articleModal.active{display:block}
    .articleBox{
      width:min(980px, 100%);
      margin:68px auto 0;
      border-radius:24px;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(10,12,26,.94);
      backdrop-filter: blur(18px) saturate(140%);
      box-shadow:0 30px 120px rgba(0,0,0,.65);
      max-height: calc(100vh - 36px);
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }
    .articleHead{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:14px 16px; border-bottom:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.03)}
    .articleHead b{font-family:var(--serif); letter-spacing:-.01em}
    .articleBody{padding:16px; overflow:auto}
    .articleBody h2{margin:0 0 8px; font-family:var(--serif); letter-spacing:-.02em; font-size:34px; line-height:1.08}
    .articleBody .sub{margin:0 0 12px; color:var(--faint); font-weight:900; letter-spacing:.06em; text-transform:uppercase; font-size:12px}
    .articleBody .content{color:var(--muted); line-height:1.8}
    .articleBody .content p{margin:0 0 12px}
    .articleBody .content ul{margin:0 0 12px 18px}

    @media (max-width: 980px){
      .pageHero .inner{grid-template-columns:1fr}
      .blogWrap{grid-template-columns:1fr}
      .sidePanel{position:static}
      .pageHero h1{font-size:34px}
    }

  </style>
</head>

<body>
  <div class="stars" aria-hidden="true"></div>
  <a class="skip" href="#main">Skip to content</a>

  <div class="wrap">
    <div class="announce" role="status" aria-live="polite">
      <span class="pill">Studio Notes</span>
      <span><b>Fresh posts</b> · Ritual ideas · Cosmic design process · Mythic lore you can use today</span>
    </div>

<header role="banner" aria-label="Site header">
      <a class="brand" href="index.html" aria-label="Virtual Utopia Designz home">
        <span class="mark" aria-hidden="true"></span>
        <span style="display:flex; flex-direction:column; min-width:0">
          <span class="name">Virtual Utopia Designz</span>
          <span class="tag">The Enchanted Atelier • Altar cards • Cosmic art • Mythic packs</span>
        </span>
      </a>

      <nav aria-label="Primary">
        <a href="index.html">Home</a>
    <a href="index.html#featured">Featured</a>
<a href="index.html#collections">Collections</a>
<a href="index.html#why">Why Us</a>
        <a href="blog.html" aria-current="page">Blog</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
      </nav>

      <div class="actions">

<button class="btn menuBtn" type="button" id="menuBtn" aria-label="Open menu" aria-expanded="false" aria-controls="mobileMenu">
  <svg class="menuIcon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
    <path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
  </svg>
  Menu
</button>
        <a class="btn" href="#featured" aria-label="Browse products">
          <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M7 7h14l-2 9H8L7 7Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/><path d="M7 7 6 3H3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M9 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" fill="currentColor"/><path d="M18 21a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" fill="currentColor"/></svg>
          Shop
        </a>
        <a class="btn btn-primary" href="https://www.etsy.com/de/shop/VirtualUtopiaDesignz" target="_blank" rel="noopener noreferrer" aria-label="Open Etsy shop in a new tab">
          Shop on Etsy
          <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M14 5h5v5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M10 14 19 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M19 14v5H5V5h5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </a>
      </div>
    </header>


<!-- Mobile menu drawer -->
<div class="mobile-drawer" id="mobileMenu" aria-hidden="true">
  <div class="mobile-panel" role="dialog" aria-modal="true" aria-label="Mobile menu">
    <div class="head">
      <b>Menu</b>
      <button class="close" type="button" id="menuClose" aria-label="Close menu">✕</button>
    </div>
    <div class="mobile-links" role="navigation" aria-label="Mobile primary">
      <a href="index.html">Home</a>
     <a href="index.html#featured">Featured</a>
<a href="index.html#collections">Collections</a>
<a href="index.html#why">Why Us</a>
      <a href="blog.html" aria-current="page">Blog</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
    </div>
    <div class="mobile-cta" aria-label="Mobile actions">
      <a class="btn" href="#featured" aria-label="Browse products">Shop</a>
      <a class="btn btn-primary" href="https://www.etsy.com/de/shop/VirtualUtopiaDesignz" target="_blank" rel="noopener noreferrer" aria-label="Open Etsy shop in a new tab">Shop on Etsy</a>
    </div>
  </div>
</div>

    <main id="main" role="main" aria-label="Blog">
      <section class="pageHero" aria-label="Blog hero">
        <div class="inner">
          <div>
            <div class="kicker"><span class="dot" aria-hidden="true"></span> Notes from the Enchanted Atelier</div>
            <h1>The Blog</h1>
            <p>Ritual notes, mythic lore, design process, and printable altar art ideas — written in the same shimmering language as our cards. New posts appear here as the studio releases fresh drops.</p>

            <div class="searchRow" role="search" aria-label="Search posts">
              <input id="q" class="input" type="search" placeholder="Search posts (e.g., protection, moon, archetypes)…" autocomplete="off" />
              <select id="cat" class="select" aria-label="Filter by category">
                <option value="">All categories</option>
              </select>
              <select id="sort" class="select" aria-label="Sort posts">
                <option value="new">Newest first</option>
                <option value="old">Oldest first</option>
                <option value="az">Title A–Z</option>
              </select>
            </div>
          </div>

          <div class="panel" aria-label="Subscribe">
            <h3>Get the next drop</h3>
            <p>For migration later: connect this form to your email provider (Mailchimp/Klaviyo/ConvertKit). For now it’s a safe placeholder that validates on-device.</p>
            <form id="subForm" class="searchRow" style="margin-top:12px" novalidate>
              <input class="input" id="email" type="email" placeholder="you@domain.com" inputmode="email" autocomplete="email" required />
              <button class="btn btn-primary" type="submit">Subscribe</button>
            </form>
            <p id="subMsg" style="margin-top:10px; color:var(--faint); font-weight:800; font-size:12px; letter-spacing:.04em"></p>
          </div>
        </div>
      </section>

      <section class="blogWrap" aria-label="Blog content">
        <div>
          <div class="posts" id="posts" aria-live="polite"></div>
          <div class="pager" aria-label="Pagination">
            <button class="btn" id="prev" type="button">Previous</button>
            <button class="btn" id="next" type="button">Next</button>
          </div>
        </div>

        <aside class="sidePanel" aria-label="Sidebar">
          <div class="panel">
            <h3>Start here</h3>
            <p>If you’re new: begin with a simple altar layout, pick one archetype, and let the week reveal its message. The posts below are crafted to be printed, saved, and revisited.</p>
            <div class="tagRow" aria-label="Quick tags" style="margin-top:12px">
              <button class="btn" type="button" data-tag="Ritual" style="padding:10px 12px">#Ritual</button>
              <button class="btn" type="button" data-tag="Protection" style="padding:10px 12px">#Protection</button>
              <button class="btn" type="button" data-tag="Moon" style="padding:10px 12px">#Moon</button>
              <button class="btn" type="button" data-tag="Creative" style="padding:10px 12px">#Creative</button>
            </div>
          </div>

          <div class="panel" aria-label="Newest posts">
            <h3>Newest Posts</h3>
            <div class="list" id="popular"></div>
          </div>
          </div>
        </aside>
      </section>

      <!-- Article modal -->
      <div class="articleModal" id="articleModal" aria-hidden="true">
        <div class="articleBox" role="dialog" aria-modal="true" aria-label="Article">
          <div class="articleHead">
            <b id="articleCrumb">Blog</b>
            <button class="close" type="button" id="articleClose" aria-label="Close article">✕</button>
          </div>
          <div class="articleBody">
            <h2 id="articleTitle">Title</h2>
            <div class="sub" id="articleMeta">Meta</div>
            <div class="content" id="articleContent"></div>
            <div class="tagRow" id="articleTags" style="margin-top:14px"></div>
          </div>
        </div>
      </div>

      <!-- Structured data: Blog + posts (generated by JS for easy future CMS migration) -->
      <script type="application/ld+json" id="jsonld"></script>
    </main>


<footer role="contentinfo" aria-label="Footer">
      <div>
        <h5>About the Enchanted Atelier</h5>
        <p>Virtual Utopia Designz creates sacred altar cards and cosmic art designed to transform everyday rituals into mythic moments — with a premium storefront experience that sells.</p>
        <div class="newsletter" aria-label="Newsletter signup">
          <div class="field" role="group" aria-label="Email address">
            <span aria-hidden="true">✉️</span>
            <input id="email" type="email" placeholder="Get new drops & ritual prompts" autocomplete="email" />
          </div>
          <button class="btn btn-primary" type="button" id="notifyBtn" aria-label="Notify me">Notify me</button>
        </div>
        <p id="note" style="margin-top:10px; color:var(--faint); font-size:12px; display:none;">Thanks — your request is noted locally (demo). For a real list, connect this button to your email provider.</p>
      </div>

      <div>
        <h5>Quick links</h5>
        <div class="links">
          <a href="#featured">Featured</a>
          <a href="#collections">Collections</a>
         <a href="blog.html">Blog</a>
          <a href="about.html">About</a>
          <a href="contact.html">Contact</a>
        </div>
      </div>

      <div>
        <h5>Store policies</h5>
        <div class="links">
          <a href="agb.html">AGB</a>
          <a href="impressum.html">Impressum</a>
          <a href="https://www.etsy.com/de/shop/VirtualUtopiaDesignz" target="_blank" rel="noopener noreferrer">Etsy shop</a>
        </div>
        <p style="margin-top:14px; font-size:12px; color:rgba(238,241,255,.55)">© <span id="year"></span> Virtual Utopia Designz</p>
      </div>
    </footer>
  </div>

  <!-- Preview modal -->
  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="mTitle" tabindex="-1">
    <div class="modal-card">
      <div class="modal-grid">
        <div class="modal-media">
          <img id="mImg" src="" alt="" />
        </div>
        <div class="modal-body">
          <div class="modal-top">
            <h3 class="modal-title" id="mTitle">Preview</h3>
            <button class="close" type="button" id="mClose" aria-label="Close preview">✕</button>
          </div>
          <p id="mBlurb"></p>
          <div class="modal-actions">
            <a class="btn btn-primary" id="mBuy" href="#" target="_blank" rel="noopener noreferrer" aria-label="Buy on Etsy">Buy on Etsy</a>
            <button class="btn" type="button" id="mCopy" aria-label="Copy Etsy link">Copy link</button>
          </div>
          <p style="margin-top:14px; color:rgba(238,241,255,.55); font-size:12px">Tip: press <b>Esc</b> to close.</p>
        </div>
      </div>
    </div>
  </div>

  

  <script>

    async function copyTextSmart(text){
      // Clipboard API requires a secure context (HTTPS or localhost)
      if (window.isSecureContext && navigator.clipboard && navigator.clipboard.writeText){
        return navigator.clipboard.writeText(text);
      }
      // Fallback for insecure contexts / older browsers
      const ta = document.createElement('textarea');
      ta.value = text;
      ta.setAttribute('readonly','');
      ta.style.position = 'fixed';
      ta.style.top = '-1000px';
      ta.style.left = '-1000px';
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, ta.value.length);
      const ok = document.execCommand('copy');
      document.body.removeChild(ta);
      if(!ok) throw new Error('execCommand copy failed');
    }

    // ===== Mobile menu (same behavior as the main site) =====
    (function(){
      const btn = document.getElementById('menuBtn');
      const drawer = document.getElementById('mobileMenu');
      const close = document.getElementById('menuClose');
      if(!btn || !drawer || !close) return;

      const open = () => {
        drawer.classList.add('active');
        drawer.setAttribute('aria-hidden','false');
        btn.setAttribute('aria-expanded','true');
        document.body.style.overflow = 'hidden';
      };
      const shut = () => {
        drawer.classList.remove('active');
        drawer.setAttribute('aria-hidden','true');
        btn.setAttribute('aria-expanded','false');
        document.body.style.overflow = '';
      };

      btn.addEventListener('click', open);
      close.addEventListener('click', shut);
      drawer.addEventListener('click', (e)=>{ if(e.target === drawer) shut(); });
      window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') shut(); });

      // Only show the button when nav is hidden by CSS breakpoint
      const mq = window.matchMedia('(max-width: 980px)');
      const sync = () => { btn.style.display = mq.matches ? 'inline-flex' : 'none'; if(!mq.matches) shut(); };
      sync();
      mq.addEventListener?.('change', sync);
    })();

    // ===== Blog data (Supabase) =====
    // This keeps the same UI + interactions, but swaps the hardcoded demo posts
    // for live posts stored in Supabase.
    const SUPABASE_URL = "https://gdwoslsaapkomtolusvz.supabase.co";
    const SUPABASE_KEY = "sb_publishable_o0Lrswtv9uXi7DxHRW8zQA_cN_-w7ki";

    let POSTS = [];

    function estimateMinutes(text){
      const words = (text || '').trim().split(/\s+/).filter(Boolean).length;
      return Math.max(2, Math.round(words / 200)); // ~200 wpm
    }

    function parseTags(v){
      if(Array.isArray(v)) return v.filter(Boolean).map(String);
      if(!v) return [];
      return String(v).split(',').map(s => s.trim()).filter(Boolean);
    }

    async function loadPostsFromSupabase(){
      // Only fetch published posts; newest first.
      const url =
        SUPABASE_URL +
        "/rest/v1/posts?select=id,created_at,title,slug,excerpt,content,cover_url,tags,published&published=eq.true&order=created_at.desc";

      const res = await fetch(url, {
        headers: {
          "apikey": SUPABASE_KEY,
          "Authorization": "Bearer " + SUPABASE_KEY
        }
      });

      if(!res.ok){
        const msg = await res.text().catch(()=> "");
        throw new Error("Supabase error: " + res.status + " " + msg);
      }

      const rows = await res.json();

      // Map DB rows to the UI shape this page already uses.
      POSTS = rows.map(r => {
        const body = (r.content || '').trim();
        const tags = parseTags(r.tags);
        return {
          id: (r.slug && String(r.slug).trim()) ? String(r.slug).trim() : String(r.id),
          title: r.title || "Untitled",
          date: (r.created_at || new Date().toISOString()),
          category: "Studio Notes",
          tags,
          minutes: estimateMinutes(body),
          excerpt: r.excerpt || "",
          // keep array format for existing renderer/modal
          content: body ? body.split(/\n{2,}/).map(p => p.trim()).filter(Boolean) : ["(No content yet)"]
        };
      });

      return POSTS;
    }


    // ===== Blog rendering =====
    const state = { page: 1, perPage: 3, q: '', cat: '', sort: 'new', tag: '' };

    const elPosts = document.getElementById('posts');
    const elPopular = document.getElementById('popular');
    const elQ = document.getElementById('q');
    const elCat = document.getElementById('cat');
    const elSort = document.getElementById('sort');
    const btnPrev = document.getElementById('prev');
    const btnNext = document.getElementById('next');

    const modal = document.getElementById('articleModal');
    const modalClose = document.getElementById('articleClose');
    const aTitle = document.getElementById('articleTitle');
    const aMeta = document.getElementById('articleMeta');
    const aContent = document.getElementById('articleContent');
    const aTags = document.getElementById('articleTags');

    function fmtDate(iso){
      const s = String(iso || '');
      const d = s.includes('T') ? new Date(s) : new Date(s + 'T12:00:00');
      return d.toLocaleDateString(undefined, { year:'numeric', month:'long', day:'numeric' });
    }

    function slugToUrl(slug){
  const s = encodeURIComponent(slug);

  // If running on GitHub Pages, use the real file URL
  if (location.hostname.endsWith('github.io')) {
    return '/post.html?slug=' + s;
  }

  // On your real site (Netlify), use the nice URL
  return '/blog/' + s;
}

    function normalize(s){ return (s||'').toLowerCase(); }

    function filtered(){
      let arr = [...POSTS];
      // tag quick filter
      if(state.tag){
        arr = arr.filter(p => p.tags.map(normalize).includes(normalize(state.tag)));
      }
      // category
      if(state.cat){
        arr = arr.filter(p => p.category === state.cat);
      }
      // search
      if(state.q){
        const q = normalize(state.q);
        arr = arr.filter(p => (normalize(p.title).includes(q) || normalize(p.excerpt).includes(q) || p.tags.some(t => normalize(t).includes(q)) ));
      }
      // sort
      if(state.sort === 'new') arr.sort((a,b)=> b.date.localeCompare(a.date));
      if(state.sort === 'old') arr.sort((a,b)=> a.date.localeCompare(b.date));
      if(state.sort === 'az') arr.sort((a,b)=> a.title.localeCompare(b.title));
      return arr;
    }

    function card(post){
      const tagHtml = post.tags.slice(0,4).map(t => `<span class="tagChip">${t}</span>`).join('');
      return `
        <article class="postCard" id="${post.id}">
          <div class="postIn">
            <div class="meta"><span class="dot" aria-hidden="true"></span> ${post.category} <span aria-hidden="true">•</span> ${fmtDate(post.date)} <span aria-hidden="true">•</span> ${post.minutes} min read</div>
            <h2 class="postTitle">${post.title}</h2>
            <p class="excerpt">${post.excerpt}</p>
            <div class="tagRow" aria-label="Tags">${tagHtml}</div>
            <div class="postActions">
          <a class="btn readBtn" href="${slugToUrl(post.id)}" target="_blank" rel="noopener noreferrer" aria-label="Read ${post.title}">
  Read post
</a>

              <button class="btn" type="button" data-copy="${post.id}" aria-label="Copy link to ${post.title}">Copy link</button>
            </div>
          </div>
        </article>
      `;
    }

    function render(){
      const arr = filtered();
      const pages = Math.max(1, Math.ceil(arr.length / state.perPage));
      state.page = Math.min(state.page, pages);
      const start = (state.page-1)*state.perPage;
      const slice = arr.slice(start, start + state.perPage);

      elPosts.innerHTML = slice.map(card).join('') || `
        <div class="panel"><h3>No posts found</h3><p>Try a different keyword or clear filters.</p></div>
      `;

      btnPrev.disabled = state.page <= 1;
      btnNext.disabled = state.page >= pages;
      btnPrev.style.opacity = btnPrev.disabled ? .55 : 1;
      btnNext.style.opacity = btnNext.disabled ? .55 : 1;

      // Popular list = newest 3 (simple)
      const popular = [...POSTS].sort((a,b)=> b.date.localeCompare(a.date)).slice(0,3);
      elPopular.innerHTML = popular.map(p => `
        <a class="mini" href="${slugToUrl(p.id)}" data-open="${p.id}" aria-label="Open ${p.title}">
          <div>
            <b>${p.title}</b>
            <span>${p.category} • ${fmtDate(p.date)}</span>
          </div>
        </a>
      `).join('');

      // JSON-LD blog + posts
      const blog = {
        "@context":"https://schema.org",
        "@type":"Blog",
        "name":"Virtual Utopia Designz — Blog",
        "url":"https://your-domain.com/blog.html",
        "publisher": {"@type":"Organization","name":"Virtual Utopia Designz"},
        "blogPost": POSTS.map(p => ({
          "@type":"BlogPosting",
          "headline": p.title,
          "datePublished": p.date,
          "dateModified": p.date,
          "author": {"@type":"Organization","name":"Virtual Utopia Designz"},
          "publisher": {"@type":"Organization","name":"Virtual Utopia Designz"},
          "mainEntityOfPage": {"@type":"WebPage","@id":"https://your-domain.com/blog.html#" + p.id},
          "keywords": p.tags.join(', '),
          "articleSection": p.category,
          "description": p.excerpt
        }))
      };
      document.getElementById('jsonld').textContent = JSON.stringify(blog);
    }

    function fillCategoryDropdown(){
      // reset (keep the first option)
      while(elCat.options.length > 1) elCat.remove(1);
      const cats = Array.from(new Set(POSTS.map(p => p.category))).sort();
      cats.forEach(c => {
        const opt = document.createElement('option');
        opt.value = c;
        opt.textContent = c;
        elCat.appendChild(opt);
      });
    }
// Events
    elQ.addEventListener('input', () => { state.q = elQ.value.trim(); state.page = 1; render(); });
    elCat.addEventListener('change', () => { state.cat = elCat.value; state.page = 1; render(); });
    elSort.addEventListener('change', () => { state.sort = elSort.value; state.page = 1; render(); });
    btnPrev.addEventListener('click', () => { state.page = Math.max(1, state.page-1); render(); });
    btnNext.addEventListener('click', () => { state.page = state.page+1; render(); });

    // Quick tag buttons
    document.querySelectorAll('[data-tag]').forEach(btn => {
      btn.addEventListener('click', () => {
        state.tag = btn.getAttribute('data-tag') || '';
        state.page = 1;
        render();
        // helpful UX: show active tag in search input
        elQ.value = state.tag ? ('#' + state.tag) : '';
        state.q = state.tag ? state.tag : '';
      });
    });

    // Modal open/close
    function mdToHtml(md){
      // Tiny markdown-ish formatter for this demo content
      return md
        .replace(/^###\s(.+)$/gm, '<h3>$1</h3>')
        .replace(/\n-\s(.+)/g, '<ul><li>$1</li></ul>')
        .replace(/<\/ul>\s*<ul>/g, '')
        .replace(/\n\n/g, '</p><p>')
        .replace(/^/, '<p>')
        .replace(/$/, '</p>');
    }

    function openArticle(id){
      const p = POSTS.find(x => x.id === id);
      if(!p) return;
      aTitle.textContent = p.title;
      aMeta.textContent = `${p.category} • ${fmtDate(p.date)} • ${p.minutes} min read`;
      aContent.innerHTML = p.content.map(mdToHtml).join('');
      aTags.innerHTML = p.tags.map(t => `<span class="tagChip">${t}</span>`).join('');

      modal.classList.add('active');
      modal.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      // update URL hash for shareability
      if(location.hash.replace('#','') !== id) history.replaceState(null,'', '#' + id);
    }
    function closeArticle(){
      modal.classList.remove('active');
      modal.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
    }
    modalClose.addEventListener('click', closeArticle);
    modal.addEventListener('click', (e)=>{ if(e.target === modal) closeArticle(); });
    window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeArticle(); });

    // Delegated clicks
    document.addEventListener('click', async (e)=>{
      const open = e.target.closest('[data-open]');
      if(open){
        e.preventDefault();
        openArticle(open.getAttribute('data-open'));
      }
      const copy = e.target.closest('[data-copy]');
      if(copy){
        const id = copy.getAttribute('data-copy');
        const url = location.origin + slugToUrl(id);
        try{ await copyTextSmart(url); copy.textContent='Copied!'; setTimeout(()=>copy.textContent='Copy link', 900); }
        catch{ copy.textContent='Copy failed'; setTimeout(()=>copy.textContent='Copy link', 900); }
      }
    });

    // Open post from hash on load (and load Supabase posts first)
    window.addEventListener('load', async () => {
      try{
        await loadPostsFromSupabase();
      } catch(err){
        // Show a helpful message in the posts area
        elPosts.innerHTML = `
          <div class="panel">
            <h3>Could not load posts</h3>
            <p style="color:var(--muted); line-height:1.6">
              ${String(err).replace(/</g,'&lt;').replace(/>/g,'&gt;')}
            </p>
            <p style="color:var(--faint); font-weight:800; letter-spacing:.04em; font-size:12px">
              Check Supabase RLS policy (SELECT for public) and that your posts have <b>published = true</b>.
            </p>
          </div>
        `;
        return;
      }

      fillCategoryDropdown();
      render();

      const id = decodeURIComponent(location.hash.replace('#',''));
      if(id){ openArticle(id); }
    });
// Subscribe placeholder
    (function(){
      const form = document.getElementById('subForm');
      const email = document.getElementById('email');
      const msg = document.getElementById('subMsg');
      if(!form) return;
      form.addEventListener('submit', (e)=>{
        e.preventDefault();
        const v = (email.value||'').trim();
        const ok = /^\S+@\S+\.\S+$/.test(v);
        if(!ok){ msg.textContent = 'Please enter a valid email address.'; return; }
        msg.textContent = 'Subscribed (demo). Connect this form to your provider during migration.';
        form.reset();
      });
    })();
  </script>

</body>
</html>
